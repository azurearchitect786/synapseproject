{
	"name": "Notebook 1",
	"properties": {
		"nbformat": 4,
		"nbformat_minor": 2,
		"bigDataPool": {
			"referenceName": "SparkPool01",
			"type": "BigDataPoolReference"
		},
		"sessionProperties": {
			"driverMemory": "28g",
			"driverCores": 4,
			"executorMemory": "28g",
			"executorCores": 4,
			"numExecutors": 2,
			"conf": {
				"spark.dynamicAllocation.enabled": "false",
				"spark.dynamicAllocation.minExecutors": "2",
				"spark.dynamicAllocation.maxExecutors": "2",
				"spark.autotune.trackingId": "5c23b53e-5e3e-44eb-b123-247dc9b9abf0"
			}
		},
		"metadata": {
			"saveOutput": true,
			"synapse_widget": {
				"version": "0.1",
				"state": {
					"95521eaf-76c7-4c90-b47a-fb7d10e364a5": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "829",
										"3": 4,
										"4": "30.500000000000000000",
										"5": "122.000000000000000000",
										"6": "20191231",
										"7": "38.640000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									},
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "3683",
										"3": 1,
										"4": "34.440000000000000000",
										"5": "34.440000000000000000",
										"6": "20191231",
										"7": "9.940000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									},
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "812",
										"3": 1,
										"4": "28.630000000000000000",
										"5": "28.630000000000000000",
										"6": "20191231",
										"7": "7.200000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									},
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "117",
										"3": 2,
										"4": "25.500000000000000000",
										"5": "51.000000000000000000",
										"6": "20191231",
										"7": "15.660000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									},
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "406",
										"3": 3,
										"4": "36.590000000000000000",
										"5": "109.770000000000000000",
										"6": "20191231",
										"7": "34.710000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									},
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "231",
										"3": 3,
										"4": "25.580000000000000000",
										"5": "76.740000000000000000",
										"6": "20191231",
										"7": "25.020000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									},
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "2689",
										"3": 3,
										"4": "24.000000000000000000",
										"5": "72.000000000000000000",
										"6": "20191231",
										"7": "19.770000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									},
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "2095",
										"3": 4,
										"4": "32.380000000000000000",
										"5": "129.520000000000000000",
										"6": "20191231",
										"7": "36.000000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									},
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "92",
										"3": 1,
										"4": "15.550000000000000000",
										"5": "15.550000000000000000",
										"6": "20191231",
										"7": "4.730000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									},
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "1912",
										"3": 1,
										"4": "24.620000000000000000",
										"5": "24.620000000000000000",
										"6": "20191231",
										"7": "7.390000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "TransactionId",
										"type": "string"
									},
									{
										"key": "1",
										"name": "CustomerId",
										"type": "int"
									},
									{
										"key": "2",
										"name": "ProductId",
										"type": "smallint"
									},
									{
										"key": "3",
										"name": "Quantity",
										"type": "tinyint"
									},
									{
										"key": "4",
										"name": "Price",
										"type": "decimal"
									},
									{
										"key": "5",
										"name": "TotalAmount",
										"type": "decimal"
									},
									{
										"key": "6",
										"name": "TransactionDate",
										"type": "int"
									},
									{
										"key": "7",
										"name": "ProfitAmount",
										"type": "decimal"
									},
									{
										"key": "8",
										"name": "Hour",
										"type": "tinyint"
									},
									{
										"key": "9",
										"name": "Minute",
										"type": "tinyint"
									},
									{
										"key": "10",
										"name": "StoreId",
										"type": "smallint"
									}
								]
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"0"
									],
									"seriesFieldKeys": [
										"1"
									],
									"isStacked": false
								}
							}
						}
					},
					"7fd70aa1-22fb-4587-9106-e85c260bf8af": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "20191231",
										"1": "124",
										"2": "36910.720000000000000000",
										"3": "2.4696",
										"4": "5243"
									},
									{
										"0": "20191231",
										"1": "968",
										"2": "3457.800000000000000000",
										"3": "2.5714",
										"4": "306"
									},
									{
										"0": "20191231",
										"1": "2049",
										"2": "2823.360000000000000000",
										"3": "2.4071",
										"4": "272"
									},
									{
										"0": "20191231",
										"1": "2603",
										"2": "18540.000000000000000000",
										"3": "2.5253",
										"4": "1500"
									},
									{
										"0": "20191231",
										"1": "4780",
										"2": "15812.790000000000000000",
										"3": "2.482",
										"4": "1519"
									},
									{
										"0": "20191231",
										"1": "3651",
										"2": "12611.700000000000000000",
										"3": "2.5194",
										"4": "1557"
									},
									{
										"0": "20191231",
										"1": "511",
										"2": "2056.600000000000000000",
										"3": "2.6804",
										"4": "260"
									},
									{
										"0": "20191231",
										"1": "2778",
										"2": "12398.320000000000000000",
										"3": "2.4547",
										"4": "1544"
									},
									{
										"0": "20191231",
										"1": "455",
										"2": "2034.960000000000000000",
										"3": "2.6522",
										"4": "244"
									},
									{
										"0": "20191231",
										"1": "4457",
										"2": "1733.200000000000000000",
										"3": "2.4138",
										"4": "280"
									},
									{
										"0": "20191231",
										"1": "1678",
										"2": "2424.840000000000000000",
										"3": "2.4694",
										"4": "242"
									},
									{
										"0": "20191231",
										"1": "2579",
										"2": "1998.880000000000000000",
										"3": "2.4554",
										"4": "248"
									},
									{
										"0": "20191231",
										"1": "4325",
										"2": "1725.750000000000000000",
										"3": "2.438",
										"4": "295"
									},
									{
										"0": "20191231",
										"1": "4661",
										"2": "2419.800000000000000000",
										"3": "2.6371",
										"4": "327"
									},
									{
										"0": "20191231",
										"1": "1159",
										"2": "3039.000000000000000000",
										"3": "2.521",
										"4": "300"
									},
									{
										"0": "20191231",
										"1": "3251",
										"2": "2659.020000000000000000",
										"3": "2.4818",
										"4": "273"
									},
									{
										"0": "20191231",
										"1": "4717",
										"2": "2209.800000000000000000",
										"3": "2.419",
										"4": "254"
									},
									{
										"0": "20191231",
										"1": "3279",
										"2": "2505.510000000000000000",
										"3": "2.7196",
										"4": "291"
									},
									{
										"0": "20191231",
										"1": "84",
										"2": "40079.280000000000000000",
										"3": "2.494",
										"4": "5387"
									},
									{
										"0": "20191231",
										"1": "224",
										"2": "61469.220000000000000000",
										"3": "2.5074",
										"4": "4754"
									},
									{
										"0": "20191231",
										"1": "2966",
										"2": "2648.440000000000000000",
										"3": "2.5391",
										"4": "292"
									},
									{
										"0": "20191231",
										"1": "472",
										"2": "15967.600000000000000000",
										"3": "2.534",
										"4": "1528"
									},
									{
										"0": "20191231",
										"1": "31",
										"2": "44940.350000000000000000",
										"3": "2.4736",
										"4": "5395"
									},
									{
										"0": "20191231",
										"1": "254",
										"2": "51838.680000000000000000",
										"3": "2.4928",
										"4": "5028"
									},
									{
										"0": "20191231",
										"1": "2677",
										"2": "2863.300000000000000000",
										"3": "2.4685",
										"4": "274"
									},
									{
										"0": "20191231",
										"1": "1075",
										"2": "2122.680000000000000000",
										"3": "2.7222",
										"4": "294"
									},
									{
										"0": "20191231",
										"1": "944",
										"2": "2284.560000000000000000",
										"3": "2.4516",
										"4": "228"
									},
									{
										"0": "20191231",
										"1": "2265",
										"2": "12190.750000000000000000",
										"3": "2.5412",
										"4": "1573"
									},
									{
										"0": "20191231",
										"1": "1260",
										"2": "13817.730000000000000000",
										"3": "2.4849",
										"4": "1481"
									},
									{
										"0": "20191231",
										"1": "4639",
										"2": "6200.790000000000000000",
										"3": "2.4538",
										"4": "1487"
									},
									{
										"0": "20191231",
										"1": "1578",
										"2": "2065.020000000000000000",
										"3": "2.4862",
										"4": "271"
									},
									{
										"0": "20191231",
										"1": "4115",
										"2": "2425.300000000000000000",
										"3": "2.5164",
										"4": "307"
									},
									{
										"0": "20191231",
										"1": "582",
										"2": "2113.040000000000000000",
										"3": "2.4898",
										"4": "244"
									},
									{
										"0": "20191231",
										"1": "2807",
										"2": "1786.050000000000000000",
										"3": "2.6064",
										"4": "245"
									},
									{
										"0": "20191231",
										"1": "3057",
										"2": "1829.190000000000000000",
										"3": "2.3861",
										"4": "241"
									},
									{
										"0": "20191231",
										"1": "3058",
										"2": "1356.420000000000000000",
										"3": "2.3697",
										"4": "282"
									},
									{
										"0": "20191231",
										"1": "3967",
										"2": "1833.280000000000000000",
										"3": "2.4727",
										"4": "272"
									},
									{
										"0": "20191231",
										"1": "4189",
										"2": "2182.700000000000000000",
										"3": "2.5339",
										"4": "299"
									},
									{
										"0": "20191231",
										"1": "2927",
										"2": "2360.400000000000000000",
										"3": "2.4649",
										"4": "281"
									},
									{
										"0": "20191231",
										"1": "2934",
										"2": "8042.320000000000000000",
										"3": "2.4742",
										"4": "1628"
									},
									{
										"0": "20191231",
										"1": "1714",
										"2": "2762.320000000000000000",
										"3": "2.5614",
										"4": "292"
									},
									{
										"0": "20191231",
										"1": "4508",
										"2": "9657.120000000000000000",
										"3": "2.4759",
										"4": "1488"
									},
									{
										"0": "20191231",
										"1": "206",
										"2": "44350.150000000000000000",
										"3": "2.4768",
										"4": "4805"
									},
									{
										"0": "20191231",
										"1": "348",
										"2": "12704.180000000000000000",
										"3": "2.4675",
										"4": "1594"
									},
									{
										"0": "20191231",
										"1": "3534",
										"2": "12637.120000000000000000",
										"3": "2.4374",
										"4": "1616"
									},
									{
										"0": "20191231",
										"1": "4296",
										"2": "2286.720000000000000000",
										"3": "2.6182",
										"4": "288"
									},
									{
										"0": "20191231",
										"1": "3698",
										"2": "3399.480000000000000000",
										"3": "2.5455",
										"4": "252"
									},
									{
										"0": "20191231",
										"1": "768",
										"2": "15691.360000000000000000",
										"3": "2.5897",
										"4": "1616"
									},
									{
										"0": "20191231",
										"1": "1725",
										"2": "2970.400000000000000000",
										"3": "2.5902",
										"4": "316"
									},
									{
										"0": "20191231",
										"1": "1435",
										"2": "1696.500000000000000000",
										"3": "2.4124",
										"4": "234"
									},
									{
										"0": "20191231",
										"1": "4724",
										"2": "2070.750000000000000000",
										"3": "2.4369",
										"4": "251"
									},
									{
										"0": "20191231",
										"1": "1850",
										"2": "2502.040000000000000000",
										"3": "2.5357",
										"4": "284"
									},
									{
										"0": "20191231",
										"1": "986",
										"2": "1860.480000000000000000",
										"3": "2.4918",
										"4": "304"
									},
									{
										"0": "20191231",
										"1": "4883",
										"2": "1928.640000000000000000",
										"3": "2.625",
										"4": "294"
									},
									{
										"0": "20191231",
										"1": "2742",
										"2": "2155.860000000000000000",
										"3": "2.4623",
										"4": "261"
									},
									{
										"0": "20191231",
										"1": "1473",
										"2": "1969.000000000000000000",
										"3": "2.3913",
										"4": "220"
									},
									{
										"0": "20191231",
										"1": "1918",
										"2": "2391.040000000000000000",
										"3": "2.4615",
										"4": "256"
									},
									{
										"0": "20191231",
										"1": "3806",
										"2": "2837.250000000000000000",
										"3": "2.5",
										"4": "325"
									},
									{
										"0": "20191231",
										"1": "1886",
										"2": "1638.560000000000000000",
										"3": "2.3937",
										"4": "304"
									},
									{
										"0": "20191231",
										"1": "1841",
										"2": "2026.650000000000000000",
										"3": "2.5214",
										"4": "295"
									},
									{
										"0": "20191231",
										"1": "1697",
										"2": "2013.480000000000000000",
										"3": "2.6355",
										"4": "282"
									},
									{
										"0": "20191231",
										"1": "887",
										"2": "1623.820000000000000000",
										"3": "2.5208",
										"4": "242"
									},
									{
										"0": "20191231",
										"1": "10",
										"2": "18557.010000000000000000",
										"3": "2.5057",
										"4": "5029"
									},
									{
										"0": "20191231",
										"1": "2093",
										"2": "17624.340000000000000000",
										"3": "2.4751",
										"4": "1641"
									},
									{
										"0": "20191231",
										"1": "2031",
										"2": "2278.140000000000000000",
										"3": "2.7158",
										"4": "258"
									},
									{
										"0": "20191231",
										"1": "3400",
										"2": "12121.200000000000000000",
										"3": "2.5407",
										"4": "1560"
									},
									{
										"0": "20191231",
										"1": "1720",
										"2": "2870.000000000000000000",
										"3": "2.5225",
										"4": "280"
									},
									{
										"0": "20191231",
										"1": "2428",
										"2": "18662.000000000000000000",
										"3": "2.5337",
										"4": "1505"
									},
									{
										"0": "20191231",
										"1": "2990",
										"2": "9452.800000000000000000",
										"3": "2.5076",
										"4": "1477"
									},
									{
										"0": "20191231",
										"1": "1865",
										"2": "1350.000000000000000000",
										"3": "2.5962",
										"4": "270"
									},
									{
										"0": "20191231",
										"1": "3659",
										"2": "2285.280000000000000000",
										"3": "2.5091",
										"4": "276"
									},
									{
										"0": "20191231",
										"1": "506",
										"2": "2801.550000000000000000",
										"3": "2.6887",
										"4": "285"
									},
									{
										"0": "20191231",
										"1": "1344",
										"2": "2413.620000000000000000",
										"3": "2.5039",
										"4": "318"
									},
									{
										"0": "20191231",
										"1": "3551",
										"2": "1996.170000000000000000",
										"3": "2.53",
										"4": "253"
									},
									{
										"0": "20191231",
										"1": "647",
										"2": "3413.300000000000000000",
										"3": "2.5893",
										"4": "290"
									},
									{
										"0": "20191231",
										"1": "3358",
										"2": "1300.420000000000000000",
										"3": "2.4095",
										"4": "253"
									},
									{
										"0": "20191231",
										"1": "1456",
										"2": "2390.510000000000000000",
										"3": "2.5413",
										"4": "277"
									},
									{
										"0": "20191231",
										"1": "2439",
										"2": "2235.750000000000000000",
										"3": "2.5463",
										"4": "275"
									},
									{
										"0": "20191231",
										"1": "2119",
										"2": "2559.910000000000000000",
										"3": "2.6019",
										"4": "281"
									},
									{
										"0": "20191231",
										"1": "4792",
										"2": "1992.150000000000000000",
										"3": "2.3069",
										"4": "233"
									},
									{
										"0": "20191231",
										"1": "1513",
										"2": "1270.080000000000000000",
										"3": "2.6916",
										"4": "288"
									},
									{
										"0": "20191231",
										"1": "168",
										"2": "21620.400000000000000000",
										"3": "2.509",
										"4": "5028"
									},
									{
										"0": "20191231",
										"1": "1923",
										"2": "9860.670000000000000000",
										"3": "2.5087",
										"4": "1593"
									},
									{
										"0": "20191231",
										"1": "4926",
										"2": "10276.660000000000000000",
										"3": "2.554",
										"4": "1466"
									},
									{
										"0": "20191231",
										"1": "2058",
										"2": "2489.940000000000000000",
										"3": "2.4393",
										"4": "261"
									},
									{
										"0": "20191231",
										"1": "4412",
										"2": "14425.740000000000000000",
										"3": "2.5134",
										"4": "1498"
									},
									{
										"0": "20191231",
										"1": "1816",
										"2": "12680.520000000000000000",
										"3": "2.4568",
										"4": "1506"
									},
									{
										"0": "20191231",
										"1": "42",
										"2": "61260.840000000000000000",
										"3": "2.4957",
										"4": "5196"
									},
									{
										"0": "20191231",
										"1": "636",
										"2": "2773.390000000000000000",
										"3": "2.5619",
										"4": "269"
									},
									{
										"0": "20191231",
										"1": "3220",
										"2": "1544.400000000000000000",
										"3": "2.4771",
										"4": "270"
									},
									{
										"0": "20191231",
										"1": "1327",
										"2": "15717.350000000000000000",
										"3": "2.4978",
										"4": "1681"
									},
									{
										"0": "20191231",
										"1": "409",
										"2": "11472.960000000000000000",
										"3": "2.5031",
										"4": "1632"
									},
									{
										"0": "20191231",
										"1": "197",
										"2": "28309.800000000000000000",
										"3": "2.5018",
										"4": "4881"
									},
									{
										"0": "20191231",
										"1": "3115",
										"2": "10095.500000000000000000",
										"3": "2.5041",
										"4": "1525"
									},
									{
										"0": "20191231",
										"1": "1476",
										"2": "3734.620000000000000000",
										"3": "2.5138",
										"4": "274"
									},
									{
										"0": "20191231",
										"1": "713",
										"2": "2357.200000000000000000",
										"3": "2.554",
										"4": "355"
									},
									{
										"0": "20191231",
										"1": "3556",
										"2": "2369.180000000000000000",
										"3": "2.4948",
										"4": "242"
									},
									{
										"0": "20191231",
										"1": "820",
										"2": "17799.430000000000000000",
										"3": "2.4858",
										"4": "1571"
									},
									{
										"0": "20191231",
										"1": "2229",
										"2": "2276.780000000000000000",
										"3": "2.4037",
										"4": "262"
									},
									{
										"0": "20191231",
										"1": "3966",
										"2": "1382.250000000000000000",
										"3": "2.4872",
										"4": "291"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "TransactionDate",
										"type": "int"
									},
									{
										"key": "1",
										"name": "ProductId",
										"type": "smallint"
									},
									{
										"key": "2",
										"name": "(sum)ProfitAmount",
										"type": "decimal"
									},
									{
										"key": "3",
										"name": "(avg)Quantity",
										"type": "double"
									},
									{
										"key": "4",
										"name": "(sum)Quantity",
										"type": "bigint"
									}
								]
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "column",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"2"
									],
									"isStacked": false
								}
							}
						}
					},
					"78d8bfec-343c-4e42-a24c-530e6e3c0d96": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "117880",
										"1": "2809",
										"2": "1"
									},
									{
										"0": "106897",
										"1": "1473",
										"2": "1"
									},
									{
										"0": "117881",
										"1": "606",
										"2": "1"
									},
									{
										"0": "117869",
										"1": "4669",
										"2": "1"
									},
									{
										"0": "117890",
										"1": "4365",
										"2": "1"
									},
									{
										"0": "117006",
										"1": "2874",
										"2": "1"
									},
									{
										"0": "117891",
										"1": "4558",
										"2": "1"
									},
									{
										"0": "117021",
										"1": "1701",
										"2": "1"
									},
									{
										"0": "117923",
										"1": "2071",
										"2": "1"
									},
									{
										"0": "117029",
										"1": "2089",
										"2": "1"
									},
									{
										"0": "117923",
										"1": "415",
										"2": "1"
									},
									{
										"0": "117126",
										"1": "211",
										"2": "1"
									},
									{
										"0": "117935",
										"1": "4454",
										"2": "1"
									},
									{
										"0": "117151",
										"1": "3246",
										"2": "1"
									},
									{
										"0": "117952",
										"1": "4239",
										"2": "1"
									},
									{
										"0": "117157",
										"1": "135",
										"2": "1"
									},
									{
										"0": "117954",
										"1": "2238",
										"2": "1"
									},
									{
										"0": "117169",
										"1": "1367",
										"2": "1"
									},
									{
										"0": "117971",
										"1": "2896",
										"2": "1"
									},
									{
										"0": "117183",
										"1": "3847",
										"2": "1"
									},
									{
										"0": "117977",
										"1": "4456",
										"2": "1"
									},
									{
										"0": "117240",
										"1": "4270",
										"2": "1"
									},
									{
										"0": "106005",
										"1": "2569",
										"2": "1"
									},
									{
										"0": "117244",
										"1": "4851",
										"2": "1"
									},
									{
										"0": "106010",
										"1": "2417",
										"2": "1"
									},
									{
										"0": "117270",
										"1": "503",
										"2": "1"
									},
									{
										"0": "106035",
										"1": "1783",
										"2": "1"
									},
									{
										"0": "117334",
										"1": "3946",
										"2": "1"
									},
									{
										"0": "106035",
										"1": "1046",
										"2": "1"
									},
									{
										"0": "117089",
										"1": "3102",
										"2": "1"
									},
									{
										"0": "106037",
										"1": "3411",
										"2": "1"
									},
									{
										"0": "117044",
										"1": "4323",
										"2": "1"
									},
									{
										"0": "106051",
										"1": "233",
										"2": "1"
									},
									{
										"0": "117039",
										"1": "4327",
										"2": "1"
									},
									{
										"0": "106053",
										"1": "4384",
										"2": "1"
									},
									{
										"0": "117425",
										"1": "1190",
										"2": "1"
									},
									{
										"0": "106057",
										"1": "1495",
										"2": "1"
									},
									{
										"0": "117430",
										"1": "1496",
										"2": "1"
									},
									{
										"0": "106069",
										"1": "98",
										"2": "1"
									},
									{
										"0": "117440",
										"1": "127",
										"2": "1"
									},
									{
										"0": "106069",
										"1": "3879",
										"2": "1"
									},
									{
										"0": "117455",
										"1": "3339",
										"2": "1"
									},
									{
										"0": "106069",
										"1": "1888",
										"2": "1"
									},
									{
										"0": "117460",
										"1": "4468",
										"2": "1"
									},
									{
										"0": "106070",
										"1": "579",
										"2": "1"
									},
									{
										"0": "117471",
										"1": "1830",
										"2": "1"
									},
									{
										"0": "106086",
										"1": "2651",
										"2": "1"
									},
									{
										"0": "117490",
										"1": "2478",
										"2": "1"
									},
									{
										"0": "106091",
										"1": "2541",
										"2": "1"
									},
									{
										"0": "117516",
										"1": "807",
										"2": "1"
									},
									{
										"0": "106097",
										"1": "3869",
										"2": "1"
									},
									{
										"0": "117520",
										"1": "3794",
										"2": "1"
									},
									{
										"0": "106097",
										"1": "4589",
										"2": "1"
									},
									{
										"0": "117536",
										"1": "1055",
										"2": "1"
									},
									{
										"0": "106098",
										"1": "631",
										"2": "1"
									},
									{
										"0": "117565",
										"1": "3205",
										"2": "1"
									},
									{
										"0": "106100",
										"1": "3959",
										"2": "1"
									},
									{
										"0": "117572",
										"1": "4286",
										"2": "1"
									},
									{
										"0": "106107",
										"1": "1199",
										"2": "1"
									},
									{
										"0": "117614",
										"1": "3845",
										"2": "1"
									},
									{
										"0": "106118",
										"1": "1893",
										"2": "1"
									},
									{
										"0": "117618",
										"1": "800",
										"2": "1"
									},
									{
										"0": "106128",
										"1": "1760",
										"2": "1"
									},
									{
										"0": "117621",
										"1": "3269",
										"2": "1"
									},
									{
										"0": "106131",
										"1": "908",
										"2": "1"
									},
									{
										"0": "117622",
										"1": "4744",
										"2": "1"
									},
									{
										"0": "106151",
										"1": "291",
										"2": "1"
									},
									{
										"0": "117632",
										"1": "1173",
										"2": "1"
									},
									{
										"0": "106167",
										"1": "1463",
										"2": "1"
									},
									{
										"0": "117652",
										"1": "4117",
										"2": "1"
									},
									{
										"0": "106175",
										"1": "4258",
										"2": "1"
									},
									{
										"0": "117688",
										"1": "4587",
										"2": "1"
									},
									{
										"0": "106186",
										"1": "865",
										"2": "1"
									},
									{
										"0": "117695",
										"1": "4031",
										"2": "1"
									},
									{
										"0": "106201",
										"1": "4409",
										"2": "1"
									},
									{
										"0": "117757",
										"1": "4511",
										"2": "1"
									},
									{
										"0": "106208",
										"1": "1736",
										"2": "1"
									},
									{
										"0": "117780",
										"1": "138",
										"2": "1"
									},
									{
										"0": "106220",
										"1": "209",
										"2": "1"
									},
									{
										"0": "117803",
										"1": "195",
										"2": "1"
									},
									{
										"0": "106230",
										"1": "148",
										"2": "1"
									},
									{
										"0": "117814",
										"1": "249",
										"2": "1"
									},
									{
										"0": "106233",
										"1": "4552",
										"2": "1"
									},
									{
										"0": "117824",
										"1": "1934",
										"2": "1"
									},
									{
										"0": "106246",
										"1": "1984",
										"2": "1"
									},
									{
										"0": "117830",
										"1": "67",
										"2": "1"
									},
									{
										"0": "106248",
										"1": "1315",
										"2": "1"
									},
									{
										"0": "117842",
										"1": "96",
										"2": "1"
									},
									{
										"0": "106271",
										"1": "1639",
										"2": "1"
									},
									{
										"0": "106403",
										"1": "2895",
										"2": "1"
									},
									{
										"0": "106894",
										"1": "1280",
										"2": "1"
									},
									{
										"0": "106407",
										"1": "2372",
										"2": "1"
									},
									{
										"0": "117395",
										"1": "2673",
										"2": "1"
									},
									{
										"0": "106415",
										"1": "2494",
										"2": "1"
									},
									{
										"0": "117407",
										"1": "2015",
										"2": "1"
									},
									{
										"0": "106418",
										"1": "3856",
										"2": "1"
									},
									{
										"0": "117147",
										"1": "1860",
										"2": "1"
									},
									{
										"0": "106435",
										"1": "2969",
										"2": "1"
									},
									{
										"0": "117373",
										"1": "2064",
										"2": "1"
									},
									{
										"0": "106439",
										"1": "4158",
										"2": "1"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "visitorId",
										"type": "bigint"
									},
									{
										"key": "1",
										"name": "productId",
										"type": "bigint"
									},
									{
										"key": "2",
										"name": "itemsPurchasedLast12Months",
										"type": "bigint"
									}
								]
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					},
					"62895d3b-8710-43b5-9db3-6b0759ef445f": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "80000",
										"1": "20"
									},
									{
										"0": "80001",
										"1": "20"
									},
									{
										"0": "80002",
										"1": "15"
									},
									{
										"0": "80003",
										"1": "12"
									},
									{
										"0": "80004",
										"1": "10"
									},
									{
										"0": "80005",
										"1": "13"
									},
									{
										"0": "80006",
										"1": "6"
									},
									{
										"0": "80007",
										"1": "18"
									},
									{
										"0": "80008",
										"1": "4"
									},
									{
										"0": "80009",
										"1": "16"
									},
									{
										"0": "80010",
										"1": "3"
									},
									{
										"0": "80011",
										"1": "17"
									},
									{
										"0": "80012",
										"1": "19"
									},
									{
										"0": "80013",
										"1": "6"
									},
									{
										"0": "80014",
										"1": "20"
									},
									{
										"0": "80015",
										"1": "12"
									},
									{
										"0": "80016",
										"1": "6"
									},
									{
										"0": "80017",
										"1": "1"
									},
									{
										"0": "80018",
										"1": "17"
									},
									{
										"0": "80019",
										"1": "14"
									},
									{
										"0": "80020",
										"1": "9"
									},
									{
										"0": "80021",
										"1": "18"
									},
									{
										"0": "80022",
										"1": "13"
									},
									{
										"0": "80023",
										"1": "10"
									},
									{
										"0": "80024",
										"1": "4"
									},
									{
										"0": "80025",
										"1": "13"
									},
									{
										"0": "80026",
										"1": "19"
									},
									{
										"0": "80027",
										"1": "13"
									},
									{
										"0": "80028",
										"1": "1"
									},
									{
										"0": "80029",
										"1": "4"
									},
									{
										"0": "80030",
										"1": "1"
									},
									{
										"0": "80031",
										"1": "9"
									},
									{
										"0": "80032",
										"1": "17"
									},
									{
										"0": "80033",
										"1": "8"
									},
									{
										"0": "80034",
										"1": "14"
									},
									{
										"0": "80035",
										"1": "11"
									},
									{
										"0": "80036",
										"1": "19"
									},
									{
										"0": "80037",
										"1": "10"
									},
									{
										"0": "80038",
										"1": "3"
									},
									{
										"0": "80039",
										"1": "4"
									},
									{
										"0": "80040",
										"1": "17"
									},
									{
										"0": "80041",
										"1": "6"
									},
									{
										"0": "80042",
										"1": "9"
									},
									{
										"0": "80043",
										"1": "2"
									},
									{
										"0": "80044",
										"1": "19"
									},
									{
										"0": "80045",
										"1": "6"
									},
									{
										"0": "80046",
										"1": "17"
									},
									{
										"0": "80047",
										"1": "4"
									},
									{
										"0": "80048",
										"1": "13"
									},
									{
										"0": "80049",
										"1": "16"
									},
									{
										"0": "80050",
										"1": "5"
									},
									{
										"0": "80051",
										"1": "17"
									},
									{
										"0": "80052",
										"1": "9"
									},
									{
										"0": "80053",
										"1": "4"
									},
									{
										"0": "80054",
										"1": "10"
									},
									{
										"0": "80055",
										"1": "18"
									},
									{
										"0": "80056",
										"1": "13"
									},
									{
										"0": "80057",
										"1": "9"
									},
									{
										"0": "80058",
										"1": "3"
									},
									{
										"0": "80059",
										"1": "14"
									},
									{
										"0": "80060",
										"1": "4"
									},
									{
										"0": "80061",
										"1": "6"
									},
									{
										"0": "80062",
										"1": "19"
									},
									{
										"0": "80063",
										"1": "3"
									},
									{
										"0": "80064",
										"1": "3"
									},
									{
										"0": "80066",
										"1": "4"
									},
									{
										"0": "80067",
										"1": "6"
									},
									{
										"0": "80068",
										"1": "5"
									},
									{
										"0": "80069",
										"1": "11"
									},
									{
										"0": "80070",
										"1": "8"
									},
									{
										"0": "80071",
										"1": "8"
									},
									{
										"0": "80072",
										"1": "5"
									},
									{
										"0": "80073",
										"1": "14"
									},
									{
										"0": "80074",
										"1": "12"
									},
									{
										"0": "80075",
										"1": "7"
									},
									{
										"0": "80076",
										"1": "12"
									},
									{
										"0": "80077",
										"1": "1"
									},
									{
										"0": "80078",
										"1": "6"
									},
									{
										"0": "80079",
										"1": "4"
									},
									{
										"0": "80080",
										"1": "19"
									},
									{
										"0": "80081",
										"1": "14"
									},
									{
										"0": "80082",
										"1": "15"
									},
									{
										"0": "80083",
										"1": "12"
									},
									{
										"0": "80084",
										"1": "5"
									},
									{
										"0": "80086",
										"1": "7"
									},
									{
										"0": "80087",
										"1": "1"
									},
									{
										"0": "80088",
										"1": "2"
									},
									{
										"0": "80089",
										"1": "9"
									},
									{
										"0": "80090",
										"1": "1"
									},
									{
										"0": "80091",
										"1": "10"
									},
									{
										"0": "80092",
										"1": "11"
									},
									{
										"0": "80093",
										"1": "6"
									},
									{
										"0": "80094",
										"1": "19"
									},
									{
										"0": "80095",
										"1": "1"
									},
									{
										"0": "80096",
										"1": "19"
									},
									{
										"0": "80097",
										"1": "19"
									},
									{
										"0": "80098",
										"1": "15"
									},
									{
										"0": "80099",
										"1": "8"
									},
									{
										"0": "80100",
										"1": "11"
									},
									{
										"0": "80101",
										"1": "6"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "visitorId",
										"type": "bigint"
									},
									{
										"key": "1",
										"name": "total",
										"type": "bigint"
									}
								]
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					},
					"6c2d846a-4b21-4846-adf5-ddae9ad95190": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "80000",
										"1": "1054"
									},
									{
										"0": "80001",
										"1": "834"
									},
									{
										"0": "80002",
										"1": "754"
									},
									{
										"0": "80003",
										"1": "684"
									},
									{
										"0": "80004",
										"1": "598"
									},
									{
										"0": "80005",
										"1": "615"
									},
									{
										"0": "80006",
										"1": "348"
									},
									{
										"0": "80007",
										"1": "932"
									},
									{
										"0": "80008",
										"1": "199"
									},
									{
										"0": "80009",
										"1": "787"
									},
									{
										"0": "80010",
										"1": "97"
									},
									{
										"0": "80011",
										"1": "931"
									},
									{
										"0": "80012",
										"1": "1042"
									},
									{
										"0": "80013",
										"1": "313"
									},
									{
										"0": "80014",
										"1": "1084"
									},
									{
										"0": "80015",
										"1": "496"
									},
									{
										"0": "80016",
										"1": "429"
									},
									{
										"0": "80017",
										"1": "76"
									},
									{
										"0": "80018",
										"1": "733"
									},
									{
										"0": "80019",
										"1": "743"
									},
									{
										"0": "80020",
										"1": "502"
									},
									{
										"0": "80021",
										"1": "921"
									},
									{
										"0": "80022",
										"1": "662"
									},
									{
										"0": "80023",
										"1": "461"
									},
									{
										"0": "80024",
										"1": "143"
									},
									{
										"0": "80025",
										"1": "747"
									},
									{
										"0": "80026",
										"1": "909"
									},
									{
										"0": "80027",
										"1": "681"
									},
									{
										"0": "80028",
										"1": "72"
									},
									{
										"0": "80029",
										"1": "227"
									},
									{
										"0": "80030",
										"1": "4"
									},
									{
										"0": "80031",
										"1": "654"
									},
									{
										"0": "80032",
										"1": "877"
									},
									{
										"0": "80033",
										"1": "331"
									},
									{
										"0": "80034",
										"1": "651"
									},
									{
										"0": "80035",
										"1": "496"
									},
									{
										"0": "80036",
										"1": "1045"
									},
									{
										"0": "80037",
										"1": "476"
									},
									{
										"0": "80038",
										"1": "139"
									},
									{
										"0": "80039",
										"1": "211"
									},
									{
										"0": "80040",
										"1": "913"
									},
									{
										"0": "80041",
										"1": "290"
									},
									{
										"0": "80042",
										"1": "427"
									},
									{
										"0": "80043",
										"1": "24"
									},
									{
										"0": "80044",
										"1": "728"
									},
									{
										"0": "80045",
										"1": "314"
									},
									{
										"0": "80046",
										"1": "613"
									},
									{
										"0": "80047",
										"1": "194"
									},
									{
										"0": "80048",
										"1": "708"
									},
									{
										"0": "80049",
										"1": "981"
									},
									{
										"0": "80050",
										"1": "234"
									},
									{
										"0": "80051",
										"1": "788"
									},
									{
										"0": "80052",
										"1": "395"
									},
									{
										"0": "80053",
										"1": "234"
									},
									{
										"0": "80054",
										"1": "391"
									},
									{
										"0": "80055",
										"1": "1137"
									},
									{
										"0": "80056",
										"1": "440"
									},
									{
										"0": "80057",
										"1": "474"
									},
									{
										"0": "80058",
										"1": "50"
									},
									{
										"0": "80059",
										"1": "677"
									},
									{
										"0": "80060",
										"1": "158"
									},
									{
										"0": "80061",
										"1": "212"
									},
									{
										"0": "80062",
										"1": "1009"
									},
									{
										"0": "80063",
										"1": "113"
									},
									{
										"0": "80064",
										"1": "132"
									},
									{
										"0": "80066",
										"1": "141"
									},
									{
										"0": "80067",
										"1": "381"
									},
									{
										"0": "80068",
										"1": "329"
									},
									{
										"0": "80069",
										"1": "524"
									},
									{
										"0": "80070",
										"1": "422"
									},
									{
										"0": "80071",
										"1": "322"
									},
									{
										"0": "80072",
										"1": "352"
									},
									{
										"0": "80073",
										"1": "770"
									},
									{
										"0": "80074",
										"1": "398"
									},
									{
										"0": "80075",
										"1": "185"
									},
									{
										"0": "80076",
										"1": "425"
									},
									{
										"0": "80077",
										"1": "84"
									},
									{
										"0": "80078",
										"1": "383"
									},
									{
										"0": "80079",
										"1": "250"
									},
									{
										"0": "80080",
										"1": "946"
									},
									{
										"0": "80081",
										"1": "540"
									},
									{
										"0": "80082",
										"1": "566"
									},
									{
										"0": "80083",
										"1": "726"
									},
									{
										"0": "80084",
										"1": "257"
									},
									{
										"0": "80086",
										"1": "270"
									},
									{
										"0": "80087",
										"1": "20"
									},
									{
										"0": "80088",
										"1": "27"
									},
									{
										"0": "80089",
										"1": "488"
									},
									{
										"0": "80090",
										"1": "34"
									},
									{
										"0": "80091",
										"1": "314"
									},
									{
										"0": "80092",
										"1": "535"
									},
									{
										"0": "80093",
										"1": "279"
									},
									{
										"0": "80094",
										"1": "937"
									},
									{
										"0": "80095",
										"1": "42"
									},
									{
										"0": "80096",
										"1": "807"
									},
									{
										"0": "80097",
										"1": "984"
									},
									{
										"0": "80098",
										"1": "744"
									},
									{
										"0": "80099",
										"1": "375"
									},
									{
										"0": "80100",
										"1": "510"
									},
									{
										"0": "80101",
										"1": "222"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "visitorId",
										"type": "bigint"
									},
									{
										"key": "1",
										"name": "totalItemsPurchased",
										"type": "bigint"
									}
								]
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					},
					"f89f2737-12ef-4c05-b86a-d51a6d045a92": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "2857",
										"3": 4,
										"4": "20.080000000000000000",
										"5": "80.320000000000000000",
										"6": "20191230",
										"7": "24.000000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									},
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "1488",
										"3": 1,
										"4": "26.840000000000000000",
										"5": "26.840000000000000000",
										"6": "20191230",
										"7": "6.610000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									},
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "4021",
										"3": 3,
										"4": "31.120000000000000000",
										"5": "93.360000000000000000",
										"6": "20191230",
										"7": "28.110000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									},
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "728",
										"3": 1,
										"4": "28.390000000000000000",
										"5": "28.390000000000000000",
										"6": "20191230",
										"7": "9.740000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									},
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "3107",
										"3": 1,
										"4": "26.010000000000000000",
										"5": "26.010000000000000000",
										"6": "20191230",
										"7": "7.770000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									},
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "2646",
										"3": 2,
										"4": "25.960000000000000000",
										"5": "51.920000000000000000",
										"6": "20191230",
										"7": "13.940000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									},
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "2005",
										"3": 2,
										"4": "32.460000000000000000",
										"5": "64.920000000000000000",
										"6": "20191230",
										"7": "17.600000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									},
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "2848",
										"3": 4,
										"4": "20.200000000000000000",
										"5": "80.800000000000000000",
										"6": "20191230",
										"7": "28.600000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									},
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "248",
										"3": 2,
										"4": "25.490000000000000000",
										"5": "50.980000000000000000",
										"6": "20191230",
										"7": "13.340000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									},
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "141",
										"3": 4,
										"4": "22.130000000000000000",
										"5": "88.520000000000000000",
										"6": "20191230",
										"7": "24.480000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "TransactionId",
										"type": "string"
									},
									{
										"key": "1",
										"name": "CustomerId",
										"type": "int"
									},
									{
										"key": "2",
										"name": "ProductId",
										"type": "smallint"
									},
									{
										"key": "3",
										"name": "Quantity",
										"type": "tinyint"
									},
									{
										"key": "4",
										"name": "Price",
										"type": "decimal"
									},
									{
										"key": "5",
										"name": "TotalAmount",
										"type": "decimal"
									},
									{
										"key": "6",
										"name": "TransactionDate",
										"type": "int"
									},
									{
										"key": "7",
										"name": "ProfitAmount",
										"type": "decimal"
									},
									{
										"key": "8",
										"name": "Hour",
										"type": "tinyint"
									},
									{
										"key": "9",
										"name": "Minute",
										"type": "tinyint"
									},
									{
										"key": "10",
										"name": "StoreId",
										"type": "smallint"
									}
								]
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"0"
									],
									"seriesFieldKeys": [
										"1"
									],
									"isStacked": false
								}
							}
						}
					},
					"dceade70-3e1e-4b3a-9ad5-b5323f20c0de": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "113143",
										"1": "13",
										"2": "65"
									},
									{
										"0": "113143",
										"1": "4755",
										"2": "41"
									},
									{
										"0": "113143",
										"1": "1875",
										"2": "93"
									},
									{
										"0": "113143",
										"1": "1733",
										"2": "31"
									},
									{
										"0": "113143",
										"1": "1490",
										"2": "17"
									},
									{
										"0": "113143",
										"1": "569",
										"2": "6"
									},
									{
										"0": "113143",
										"1": "3070",
										"2": "60"
									},
									{
										"0": "113143",
										"1": "1597",
										"2": "32"
									},
									{
										"0": "113143",
										"1": "1310",
										"2": "38"
									},
									{
										"0": "113143",
										"1": "1028",
										"2": "62"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "visitorId",
										"type": "bigint"
									},
									{
										"key": "1",
										"name": "productId",
										"type": "bigint"
									},
									{
										"key": "2",
										"name": "itemsPurchasedLast12Months",
										"type": "bigint"
									}
								]
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					},
					"92a024e5-f75f-4b6b-a06b-0ffe2ee33c78": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "80296",
										"1": "202",
										"2": "96.920000000000000000",
										"3": "4",
										"4": "52"
									},
									{
										"0": "80347",
										"1": "4232",
										"2": "48.860000000000000000",
										"3": "2",
										"4": "89"
									},
									{
										"0": "80351",
										"1": "244",
										"2": "83.960000000000000000",
										"3": "4",
										"4": "83"
									},
									{
										"0": "80659",
										"1": "2433",
										"2": "45.520000000000000000",
										"3": "2",
										"4": "63"
									},
									{
										"0": "80922",
										"1": "963",
										"2": "100.680000000000000000",
										"3": "4",
										"4": "51"
									},
									{
										"0": "81027",
										"1": "2158",
										"2": "43.460000000000000000",
										"3": "2",
										"4": "54"
									},
									{
										"0": "81180",
										"1": "109",
										"2": "207.920000000000000000",
										"3": "8",
										"4": "50"
									},
									{
										"0": "81686",
										"1": "3128",
										"2": "64.240000000000000000",
										"3": "2",
										"4": "93"
									},
									{
										"0": "82401",
										"1": "87",
										"2": "18.430000000000000000",
										"3": "1",
										"4": "56"
									},
									{
										"0": "82442",
										"1": "3318",
										"2": "152.040000000000000000",
										"3": "4",
										"4": "53"
									},
									{
										"0": "82467",
										"1": "3033",
										"2": "72.720000000000000000",
										"3": "3",
										"4": "32"
									},
									{
										"0": "82625",
										"1": "104",
										"2": "35.230000000000000000",
										"3": "1",
										"4": "58"
									},
									{
										"0": "82983",
										"1": "802",
										"2": "58.800000000000000000",
										"3": "2",
										"4": "4"
									},
									{
										"0": "83417",
										"1": "24",
										"2": "22.280000000000000000",
										"3": "1",
										"4": "60"
									},
									{
										"0": "83425",
										"1": "158",
										"2": "45.240000000000000000",
										"3": "2",
										"4": "26"
									},
									{
										"0": "83704",
										"1": "3164",
										"2": "116.880000000000000000",
										"3": "4",
										"4": "53"
									},
									{
										"0": "84189",
										"1": "103",
										"2": "51.780000000000000000",
										"3": "2",
										"4": "29"
									},
									{
										"0": "84245",
										"1": "177",
										"2": "68.940000000000000000",
										"3": "3",
										"4": "5"
									},
									{
										"0": "84418",
										"1": "4412",
										"2": "64.800000000000000000",
										"3": "2",
										"4": "70"
									},
									{
										"0": "84464",
										"1": "2043",
										"2": "66.600000000000000000",
										"3": "3",
										"4": "11"
									},
									{
										"0": "84483",
										"1": "1335",
										"2": "115.560000000000000000",
										"3": "4",
										"4": "76"
									},
									{
										"0": "84543",
										"1": "1379",
										"2": "29.290000000000000000",
										"3": "1",
										"4": "87"
									},
									{
										"0": "84558",
										"1": "116",
										"2": "49.380000000000000000",
										"3": "3",
										"4": "10"
									},
									{
										"0": "84833",
										"1": "63",
										"2": "31.670000000000000000",
										"3": "1",
										"4": "41"
									},
									{
										"0": "85070",
										"1": "4882",
										"2": "58.740000000000000000",
										"3": "2",
										"4": "92"
									},
									{
										"0": "85161",
										"1": "162",
										"2": "64.420000000000000000",
										"3": "2",
										"4": "99"
									},
									{
										"0": "85170",
										"1": "2934",
										"2": "103.860000000000000000",
										"3": "6",
										"4": "52"
									},
									{
										"0": "85501",
										"1": "682",
										"2": "74.280000000000000000",
										"3": "3",
										"4": "87"
									},
									{
										"0": "86205",
										"1": "115",
										"2": "61.580000000000000000",
										"3": "2",
										"4": "53"
									},
									{
										"0": "86205",
										"1": "3173",
										"2": "52.940000000000000000",
										"3": "2",
										"4": "15"
									},
									{
										"0": "86349",
										"1": "768",
										"2": "127.440000000000000000",
										"3": "4",
										"4": "76"
									},
									{
										"0": "86456",
										"1": "347",
										"2": "29.590000000000000000",
										"3": "1",
										"4": "52"
									},
									{
										"0": "86557",
										"1": "4475",
										"2": "86.640000000000000000",
										"3": "4",
										"4": "37"
									},
									{
										"0": "86629",
										"1": "200",
										"2": "74.340000000000000000",
										"3": "3",
										"4": "32"
									},
									{
										"0": "86641",
										"1": "72",
										"2": "52.060000000000000000",
										"3": "2",
										"4": "9"
									},
									{
										"0": "86811",
										"1": "3635",
										"2": "88.800000000000000000",
										"3": "3",
										"4": "51"
									},
									{
										"0": "86846",
										"1": "152",
										"2": "75.870000000000000000",
										"3": "3",
										"4": "72"
									},
									{
										"0": "87075",
										"1": "1777",
										"2": "139.240000000000000000",
										"3": "4",
										"4": "35"
									},
									{
										"0": "87086",
										"1": "2362",
										"2": "35.520000000000000000",
										"3": "1",
										"4": "80"
									},
									{
										"0": "87095",
										"1": "2911",
										"2": "65.720000000000000000",
										"3": "2",
										"4": "80"
									},
									{
										"0": "87103",
										"1": "92",
										"2": "77.750000000000000000",
										"3": "5",
										"4": "82"
									},
									{
										"0": "87126",
										"1": "154",
										"2": "52.280000000000000000",
										"3": "2",
										"4": "92"
									},
									{
										"0": "87126",
										"1": "172",
										"2": "36.970000000000000000",
										"3": "1",
										"4": "46"
									},
									{
										"0": "87142",
										"1": "101",
										"2": "127.500000000000000000",
										"3": "3",
										"4": "60"
									},
									{
										"0": "87314",
										"1": "2885",
										"2": "26.610000000000000000",
										"3": "1",
										"4": "67"
									},
									{
										"0": "87480",
										"1": "3496",
										"2": "94.620000000000000000",
										"3": "3",
										"4": "56"
									},
									{
										"0": "87546",
										"1": "3918",
										"2": "74.460000000000000000",
										"3": "3",
										"4": "70"
									},
									{
										"0": "87607",
										"1": "2307",
										"2": "141.720000000000000000",
										"3": "4",
										"4": "17"
									},
									{
										"0": "87690",
										"1": "114",
										"2": "153.920000000000000000",
										"3": "4",
										"4": "76"
									},
									{
										"0": "88259",
										"1": "2396",
										"2": "23.530000000000000000",
										"3": "1",
										"4": "22"
									},
									{
										"0": "88440",
										"1": "5",
										"2": "50.620000000000000000",
										"3": "2",
										"4": "23"
									},
									{
										"0": "88485",
										"1": "226",
										"2": "71.790000000000000000",
										"3": "3",
										"4": "20"
									},
									{
										"0": "88518",
										"1": "2287",
										"2": "46.480000000000000000",
										"3": "2",
										"4": "16"
									},
									{
										"0": "88750",
										"1": "633",
										"2": "65.320000000000000000",
										"3": "2",
										"4": "30"
									},
									{
										"0": "88796",
										"1": "885",
										"2": "26.170000000000000000",
										"3": "1",
										"4": "17"
									},
									{
										"0": "88858",
										"1": "199",
										"2": "66.660000000000000000",
										"3": "2",
										"4": "45"
									},
									{
										"0": "89226",
										"1": "3769",
										"2": "20.630000000000000000",
										"3": "1",
										"4": "12"
									},
									{
										"0": "89283",
										"1": "1772",
										"2": "105.840000000000000000",
										"3": "4",
										"4": "34"
									},
									{
										"0": "89976",
										"1": "2006",
										"2": "74.240000000000000000",
										"3": "4",
										"4": "51"
									},
									{
										"0": "90083",
										"1": "315",
										"2": "118.880000000000000000",
										"3": "4",
										"4": "9"
									},
									{
										"0": "90131",
										"1": "4896",
										"2": "46.260000000000000000",
										"3": "2",
										"4": "34"
									},
									{
										"0": "90335",
										"1": "1441",
										"2": "21.270000000000000000",
										"3": "1",
										"4": "1"
									},
									{
										"0": "90367",
										"1": "3575",
										"2": "136.320000000000000000",
										"3": "4",
										"4": "39"
									},
									{
										"0": "90652",
										"1": "34",
										"2": "88.000000000000000000",
										"3": "4",
										"4": "79"
									},
									{
										"0": "90671",
										"1": "195",
										"2": "24.140000000000000000",
										"3": "1",
										"4": "7"
									},
									{
										"0": "91493",
										"1": "4549",
										"2": "17.750000000000000000",
										"3": "1",
										"4": "31"
									},
									{
										"0": "91646",
										"1": "202",
										"2": "72.690000000000000000",
										"3": "3",
										"4": "51"
									},
									{
										"0": "91798",
										"1": "224",
										"2": "125.970000000000000000",
										"3": "3",
										"4": "62"
									},
									{
										"0": "91817",
										"1": "3651",
										"2": "101.820000000000000000",
										"3": "3",
										"4": "40"
									},
									{
										"0": "92030",
										"1": "98",
										"2": "83.250000000000000000",
										"3": "3",
										"4": "88"
									},
									{
										"0": "92293",
										"1": "27",
										"2": "95.280000000000000000",
										"3": "3",
										"4": "65"
									},
									{
										"0": "92456",
										"1": "242",
										"2": "104.560000000000000000",
										"3": "4",
										"4": "98"
									},
									{
										"0": "92543",
										"1": "173",
										"2": "95.320000000000000000",
										"3": "4",
										"4": "60"
									},
									{
										"0": "92565",
										"1": "4069",
										"2": "87.480000000000000000",
										"3": "3",
										"4": "93"
									},
									{
										"0": "92581",
										"1": "94",
										"2": "85.680000000000000000",
										"3": "3",
										"4": "54"
									},
									{
										"0": "92623",
										"1": "2015",
										"2": "31.660000000000000000",
										"3": "1",
										"4": "43"
									},
									{
										"0": "92794",
										"1": "2252",
										"2": "23.790000000000000000",
										"3": "1",
										"4": "80"
									},
									{
										"0": "92961",
										"1": "780",
										"2": "68.340000000000000000",
										"3": "3",
										"4": "66"
									},
									{
										"0": "93136",
										"1": "169",
										"2": "155.160000000000000000",
										"3": "4",
										"4": "74"
									},
									{
										"0": "93204",
										"1": "464",
										"2": "92.480000000000000000",
										"3": "4",
										"4": "13"
									},
									{
										"0": "93507",
										"1": "170",
										"2": "55.700000000000000000",
										"3": "2",
										"4": "84"
									},
									{
										"0": "93533",
										"1": "81",
										"2": "51.560000000000000000",
										"3": "2",
										"4": "19"
									},
									{
										"0": "93687",
										"1": "124",
										"2": "26.150000000000000000",
										"3": "1",
										"4": "9"
									},
									{
										"0": "93837",
										"1": "2194",
										"2": "77.550000000000000000",
										"3": "3",
										"4": "65"
									},
									{
										"0": "94256",
										"1": "2939",
										"2": "24.670000000000000000",
										"3": "1",
										"4": "27"
									},
									{
										"0": "94337",
										"1": "3143",
										"2": "43.700000000000000000",
										"3": "2",
										"4": "48"
									},
									{
										"0": "94573",
										"1": "4276",
										"2": "28.970000000000000000",
										"3": "1",
										"4": "9"
									},
									{
										"0": "94643",
										"1": "213",
										"2": "87.210000000000000000",
										"3": "3",
										"4": "12"
									},
									{
										"0": "94839",
										"1": "4472",
										"2": "25.260000000000000000",
										"3": "1",
										"4": "89"
									},
									{
										"0": "94914",
										"1": "4767",
										"2": "63.000000000000000000",
										"3": "3",
										"4": "87"
									},
									{
										"0": "95324",
										"1": "4866",
										"2": "142.920000000000000000",
										"3": "4",
										"4": "3"
									},
									{
										"0": "95392",
										"1": "27",
										"2": "95.280000000000000000",
										"3": "3",
										"4": "41"
									},
									{
										"0": "95546",
										"1": "3393",
										"2": "91.350000000000000000",
										"3": "3",
										"4": "96"
									},
									{
										"0": "95760",
										"1": "4458",
										"2": "34.270000000000000000",
										"3": "1",
										"4": "78"
									},
									{
										"0": "95776",
										"1": "2138",
										"2": "111.960000000000000000",
										"3": "4",
										"4": "47"
									},
									{
										"0": "95857",
										"1": "4837",
										"2": "26.750000000000000000",
										"3": "1",
										"4": "27"
									},
									{
										"0": "95903",
										"1": "135",
										"2": "72.480000000000000000",
										"3": "2",
										"4": "18"
									},
									{
										"0": "96097",
										"1": "4987",
										"2": "74.900000000000000000",
										"3": "2",
										"4": "52"
									},
									{
										"0": "96124",
										"1": "3319",
										"2": "119.480000000000000000",
										"3": "4",
										"4": "33"
									},
									{
										"0": "96219",
										"1": "3269",
										"2": "40.040000000000000000",
										"3": "2",
										"4": "10"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "CustomerId",
										"type": "int"
									},
									{
										"key": "1",
										"name": "productId",
										"type": "bigint"
									},
									{
										"key": "2",
										"name": "TotalAmountDecember",
										"type": "decimal"
									},
									{
										"key": "3",
										"name": "TotalQuantityDecember",
										"type": "bigint"
									},
									{
										"key": "4",
										"name": "TotalItemsPurchasedLast12Months",
										"type": "bigint"
									}
								]
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					}
				}
			},
			"enableDebugMode": false,
			"kernelspec": {
				"name": "synapse_pyspark",
				"display_name": "Synapse PySpark"
			},
			"language_info": {
				"name": "python"
			},
			"a365ComputeOptions": {
				"id": "/subscriptions/06cb8659-f29a-4c66-a432-03817fc40482/resourceGroups/data-engineering-synapse-cek6lnb/providers/Microsoft.Synapse/workspaces/asaworkspacecek6lnb/bigDataPools/SparkPool01",
				"name": "SparkPool01",
				"type": "Spark",
				"endpoint": "https://asaworkspacecek6lnb.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/SparkPool01",
				"auth": {
					"type": "AAD",
					"authResource": "https://dev.azuresynapse.net"
				},
				"sparkVersion": "2.4",
				"nodeCount": 3,
				"cores": 4,
				"memory": 28,
				"extraHeader": null
			}
		},
		"cells": [
			{
				"cell_type": "code",
				"metadata": {
					"collapsed": false
				},
				"source": [
					"%%pyspark\r\n",
					"df = spark.read.load('abfss://wwi-02@asadatalakecek6lnb.dfs.core.windows.net/sale-small/Year=2019/Quarter=Q4/Month=12/Day=20191231/sale-small-20191231-snappy.parquet', format='parquet')\r\n",
					"display(df.limit(10))"
				],
				"attachments": null,
				"execution_count": 1
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"datalake = 'asadatalakecek6lnb'\r\n",
					""
				],
				"attachments": null,
				"execution_count": 2
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"df.printSchema()\r\n",
					""
				],
				"attachments": null,
				"execution_count": 3
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"from pyspark.sql import SparkSession\r\n",
					"from pyspark.sql.types import *\r\n",
					"from pyspark.sql.functions import *\r\n",
					"\r\n",
					"profitByDateProduct = (df.groupBy(\"TransactionDate\",\"ProductId\")\r\n",
					"    .agg(\r\n",
					"        sum(\"ProfitAmount\").alias(\"(sum)ProfitAmount\"),\r\n",
					"        round(avg(\"Quantity\"), 4).alias(\"(avg)Quantity\"),\r\n",
					"        sum(\"Quantity\").alias(\"(sum)Quantity\"))\r\n",
					"    .orderBy(\"TransactionDate\"))\r\n",
					"display(profitByDateProduct.limit(100))\r\n",
					""
				],
				"attachments": null,
				"execution_count": 4
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"df = (spark.read \\\r\n",
					"        .option('inferSchema', 'true') \\\r\n",
					"        .json('abfss://wwi-02@' + datalake + '.dfs.core.windows.net/online-user-profiles-02/*.json', multiLine=True)\r\n",
					"    )\r\n",
					"\r\n",
					"df.printSchema()\r\n",
					""
				],
				"attachments": null,
				"execution_count": 5
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"# create a view called user_profiles\r\n",
					"df.createOrReplaceTempView(\"user_profiles\")\r\n",
					""
				],
				"attachments": null,
				"execution_count": 6
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"microsoft": {
						"language": "sparksql"
					},
					"collapsed": false
				},
				"source": [
					"%%sql\r\n",
					"\r\n",
					"SELECT * FROM user_profiles LIMIT 10\r\n",
					""
				],
				"attachments": null,
				"execution_count": 7
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"from pyspark.sql.functions import udf, explode\r\n",
					"\r\n",
					"flat=df.select('visitorId',explode('topProductPurchases').alias('topProductPurchases_flat'))\r\n",
					"flat.show(100)\r\n",
					""
				],
				"attachments": null,
				"execution_count": 8
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"\r\n",
					"topPurchases = (flat.select('visitorId','topProductPurchases_flat.productId','topProductPurchases_flat.itemsPurchasedLast12Months')\r\n",
					"    .orderBy('visitorId'))\r\n",
					"\r\n",
					"topPurchases.show(100)\r\n",
					""
				],
				"attachments": null,
				"execution_count": 9
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"# Let's order by the number of items purchased in the last 12 months\r\n",
					"sortedTopPurchases = topPurchases.orderBy(\"itemsPurchasedLast12Months\")\r\n",
					"\r\n",
					"display(sortedTopPurchases.limit(100))\r\n",
					""
				],
				"attachments": null,
				"execution_count": 10
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"groupedTopPurchases = (sortedTopPurchases.select(\"visitorId\")\r\n",
					"    .groupBy(\"visitorId\")\r\n",
					"    .agg(count(\"*\").alias(\"total\"))\r\n",
					"    .orderBy(\"visitorId\") )\r\n",
					"\r\n",
					"display(groupedTopPurchases.limit(100))\r\n",
					""
				],
				"attachments": null,
				"execution_count": 11
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"groupedTopPurchases = (sortedTopPurchases.select(\"visitorId\",\"itemsPurchasedLast12Months\")\r\n",
					"    .groupBy(\"visitorId\")\r\n",
					"    .agg(sum(\"itemsPurchasedLast12Months\").alias(\"totalItemsPurchased\"))\r\n",
					"    .orderBy(\"visitorId\") )\r\n",
					"\r\n",
					"display(groupedTopPurchases.limit(100))\r\n",
					""
				],
				"attachments": null,
				"execution_count": 12
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"# Create a temporary view for top purchases so we can load from Scala\r\n",
					"topPurchases.createOrReplaceTempView(\"top_purchases\")\r\n",
					""
				],
				"attachments": null,
				"execution_count": 13
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"microsoft": {
						"language": "scala"
					}
				},
				"source": [
					"%%spark\r\n",
					"// Make sure the name of the dedcated SQL pool (SQLPool01 below) matches the name of your SQL pool.\r\n",
					"val df = spark.sqlContext.sql(\"select * from top_purchases\")\r\n",
					"df.write.synapsesql(\"SQLPool01.wwi.TopPurchases\", Constants.INTERNAL)\r\n",
					""
				],
				"attachments": null,
				"execution_count": 14
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"dfsales = spark.read.load('abfss://wwi-02@' + datalake + '.dfs.core.windows.net/sale-small/Year=2019/Quarter=Q4/Month=12/*/*.parquet', format='parquet')\r\n",
					"display(dfsales.limit(10))\r\n",
					""
				],
				"attachments": null,
				"execution_count": 15
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"microsoft": {
						"language": "scala"
					}
				},
				"source": [
					"%%spark\r\n",
					"// Make sure the name of the SQL pool (SQLPool01 below) matches the name of your SQL pool.\r\n",
					"val df2 = spark.read.synapsesql(\"SQLPool01.wwi.TopPurchases\")\r\n",
					"df2.createTempView(\"top_purchases_sql\")\r\n",
					"\r\n",
					"df2.head(10)\r\n",
					""
				],
				"attachments": null,
				"execution_count": 16
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"dfTopPurchasesFromSql = sqlContext.table(\"top_purchases_sql\")\r\n",
					"\r\n",
					"display(dfTopPurchasesFromSql.limit(10))\r\n",
					""
				],
				"attachments": null,
				"execution_count": 17
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"inner_join = dfsales.join(dfTopPurchasesFromSql,\r\n",
					"    (dfsales.CustomerId == dfTopPurchasesFromSql.visitorId) & (dfsales.ProductId == dfTopPurchasesFromSql.productId))\r\n",
					"\r\n",
					"inner_join_agg = (inner_join.select(\"CustomerId\",\"TotalAmount\",\"Quantity\",\"itemsPurchasedLast12Months\",\"top_purchases_sql.productId\")\r\n",
					"    .groupBy([\"CustomerId\",\"top_purchases_sql.productId\"])\r\n",
					"    .agg(\r\n",
					"        sum(\"TotalAmount\").alias(\"TotalAmountDecember\"),\r\n",
					"        sum(\"Quantity\").alias(\"TotalQuantityDecember\"),\r\n",
					"        sum(\"itemsPurchasedLast12Months\").alias(\"TotalItemsPurchasedLast12Months\"))\r\n",
					"    .orderBy(\"CustomerId\") )\r\n",
					"\r\n",
					"display(inner_join_agg.limit(100))\r\n",
					""
				],
				"attachments": null,
				"execution_count": 18
			}
		]
	}
}